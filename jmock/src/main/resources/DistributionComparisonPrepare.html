<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <title>Distributions Comparison</title>
</head>
<style>
.bar rect { fill: steelblue; }
.bar text { fill: #fff; font: 10px sans-serif; }
</style>
<ol id="distrList">

</ol>

<script src="d3.min.js"></script>
<script src="https://d3js.org/d3-array.v2.min.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<!--<script>-->

    <!--identity(x) {-->
        <!--return x;-->
    <!--}-->

    <!--function rollup(values, reduce, ...keys) {-->
        <!--return nest(values, identity, reduce, keys);-->
    <!--}-->

    <!--function nest(values, map, reduce, keys) {-->
        <!--return (function regroup(values, i) {-->
            <!--if (i >= keys.length) return reduce(values);-->
            <!--const groups = new Map();-->
            <!--const keyof = keys[i++];-->
            <!--let index = -1;-->
            <!--for (const value of values) {-->
                <!--const key = keyof(value, ++index, values);-->
                <!--const group = groups.get(key);-->
                <!--if (group) group.push(value);-->
                <!--else groups.set(key, [value]);-->
            <!--}-->
            <!--for (const [key, values] of groups) {-->
                <!--groups.set(key, regroup(values, i));-->
            <!--}-->
            <!--return map(groups);-->
        <!--})(values, 0);-->
    <!--}-->
<!--</script>-->

<script>
var data = [
    {name: "8 - Track", year: 1973, value: 2699600000},
    {name: "8 - Track", year: 1974, value: 2730600000},
    {name: "Cassette", year: 1973, value: 419600000},
    {name: "Cassette", year: 1974, value: 1691000000} ];

var colors = new Map([
    ["8 - Track", "#5B8DB8"],
    ["Cassette", "#7AAAD0"],
]);

var color = d3.scaleOrdinal()
    .domain(Array.from(colors.keys()))
    .range(Array.from(colors.values()))

var distributionInfo = [
    {
        name:"NormalDist : mu = 409.9065606361829, sigma = 322.0531321029433"
        ,"totalOver":"3795.8879774300667"
        ,"totalUnder":"2107.0707942887157"
        ,"totalDiff":"1688.817183141351"
    },
    {
        name:"LaplaceDist : mu = 360.0, beta = 67.42942345924453"
        ,"totalOver":"702.0426478319534"
        ,"totalUnder":"2199.7553469211975"
        ,"totalDiff":"-1497.712699089244"
    },
    {
        name:"UniformDist : a = 299.0, b = 4692.0"
        ,"totalOver":"102335.44533081808"
        ,"totalUnder":"0.0"
        ,"totalDiff":"102335.44533081808"
    },
    {
        name:"Mixture Distribution: ( weight = 0.011331240604765494, NormalDist : mu = 409.9065606361829, sigma = 322.0531321029433) ( weight = 0.9151151890904212, LaplaceDist : mu = 360.0, beta = 67.42942345924453) ( weight = 0.07355357030481328, UniformDist : a = 299.0, b = 4692.0)"
        ,"totalOver":"9383.182100205888"
        ,"totalUnder":"1088.513615087585"
        ,"totalDiff":"8294.668485118302"
    },
];


var nbOfBuckets = "50";
var columns = ["distribution", "over", "under"];
var list = document.getElementById('distrList');

for(i = 0; i < 2; i++) {

    var li = document.createElement('li');
    var container = document.createElement('div');
    var row = document.createElement('div');
    var col_1 = document.createElement('div');
    var col_2 = document.createElement('div');
    var entry = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    var par_name = document.createElement('P');
    var par_totalOver = document.createElement('P');
    var par_avgOver = document.createElement('P');
    var par_totalUnder = document.createElement('P');
    var par_avgUnder = document.createElement('P');

    container.setAttribute("class", "container");
    row.setAttribute("class", "row");
    col_1.setAttribute("class", "col-md-auto");
    col_2.setAttribute("class", "col-md-auto");
    entry.setAttribute("width", "960");
    entry.setAttribute("height", "500");
    entry.id = "svg" + i;
    par_name.innerText = distributionInfo[i].name;
    par_name.setAttribute("style", "font-weight: bold");
    par_totalOver.setAttribute("style", "color:green;");
    par_totalOver.innerText = "Total Over: " + distributionInfo[i].totalOver;
    par_avgOver.setAttribute("style", "color:green;");
    par_avgOver.innerText = "Average Over: " + (distributionInfo[i].totalOver / nbOfBuckets);
    par_totalUnder.setAttribute("style", "color:red;");
    par_totalUnder.innerText = "Total Under: " + distributionInfo[i].totalUnder;
    par_avgUnder.setAttribute("style", "color:red;");
    par_avgUnder.innerText = "Average Under: " + (distributionInfo[i].totalUnder / nbOfBuckets);

    list.appendChild(li);
    li.appendChild(container);
    container.appendChild(row);
    row.appendChild(col_1);
    row.appendChild(col_2);
    col_1.appendChild(entry);
    col_2.appendChild(par_name);
    col_2.appendChild(par_totalOver);
    col_2.appendChild(par_avgOver);
    col_2.appendChild(par_totalUnder);
    col_2.appendChild(par_avgUnder);

<!--li.appendChild(entry);-->
<!--list.appendChild(li);-->
}

var width = 960, height = 500;

var margin = ({top: 20, right: 30, bottom: 30, left: 30});

for(j = 0; j < 2; j++) {

// var data = dataNested[j];

formatValue = x => isNaN(x) ? "N/A" : x.toLocaleString("en");

    series = d3.stack()
        .keys(Array.from(colors.keys()))
        .value((group, key) => group.get(key).value)
.order(d3.stackOrderReverse)
    (Array.from(d3.rollup(data, ([d]) => d, d => d.year, d => d.name).values()))
.map(s => (s.forEach(d => d.data = d.data.get(s.key)), s));

    x = d3.scaleBand()
        .domain(data.map(d => d.year))
.rangeRound([margin.left, width - margin.right]);

    y = d3.scaleLinear()
        .domain([0, d3.max(series, d => d3.max(d, d => d[1]))]).nice()
        .range([height - margin.bottom, margin.top]);

    xAxis = g => g
        .attr("transform", `translate(0,${height - margin.bottom})`)
        .call(d3.axisBottom(x)
            .tickValues([1973, 1974])
        .tickSizeOuter(0));

    yAxis = g => g
        .attr("transform", `translate(${margin.left},0)`)
        .call(d3.axisLeft(y)
            .tickFormat(x => (x / 1e9).toFixed(0)))
.call(g => g.select(".domain").remove())
.call(g => g.select(".tick:last-of-type text").clone()
        .attr("x", 3)
        .attr("text-anchor", "start")
        .attr("font-weight", "bold")
        .text(data.y));

    formatRevenue = x => (+(x / 1e9).toFixed(2) >= 1)
        ? `${(x / 1e9).toFixed(2)}B`
        : `${(x / 1e6).toFixed(0)}M`;

    const svg = d3.select("#svg"+j).attr("viewBox", [0, 0, width, height]);

    svg.append("g")
        .selectAll("g")
        .data(series)
        .join("g")
        .attr("fill", ({key}) => color(key))
.call(g => g.selectAll("rect")
        .data(d => d)
.join("rect")
        .attr("x", d => x(d.data.year))
.attr("y", d => y(d[1]))
.attr("width", x.bandwidth() - 1)
        .attr("height", d => y(d[0]) - y(d[1]))
.append("title")
        .text(d => `${d.data.name}, ${d.data.year}
${formatRevenue(d.data.value)}`));

    svg.append("g")
        .call(xAxis);

    svg.append("g")
        .call(yAxis);
}
</script>
</html>
